# FrozenSet: проект по детекированию касок

Финальный проект курса "Data Science" от СберУниверситета. Группа DS14AN, подгруппа 5 - FrozenSet.

## Участники

- Васильев Даниил
- Вебер Владислав
- Гузанов Владимир
- Фадеева Варвара

## Задача

Главная задача проекта - создание модели способной распознавать (детектировать) наличие каски на голове человека в различном окружении. Это может быть востребованно, например, на объектах промышленного производства или строительных площадках, для контроля за соблюдением техники безопасности.

## Предлагаемый подход

В качестве решения предлагается использовать обуечение с учителем моделей основанных на использвании **Сверточных нейронных сетей (Convolution Neural Networks - CNN)**.  
Основная идея заключается в обучении CNN с использованием двух классов:
- *helmet* для случая наличия на голове каски
- *head* для случая отсутствия на голове каски

Предполагается, что обученная модель сможет детектировать голову без каски (*head*) и голову с каской (*helmet*) на произвольном изображении.

Для решения задачи необходимы следующие элементы:

1. Датасет для обучения с размеченными классами
2. CNN модель.
3. Интерфейс для организации предсказания по обученным моделям.

## Датасет

### Описание
Датасет SafetyHelmetWearing-Dataset(SHWD) с размеченными изображениями. В датасете присутствуют следующие метки "person" для головы и "hat" - для головы со шлемом.

[Ссылка на проект с датасетом](https://github.com/njvisionpower/Safety-Helmet-Wearing-Dataset)

[Ссылка для скачивания с Google Drive](https://drive.google.com/file/d/1qWm7rrwvjAWs1slymbrLaCf7Q-wnGLEX/view)

### Короткое описание со странички проекта

SafetyHelmetWearing-Dataset(SHWD)

"SHWD provide the dataset used for both safety helmet wearing and human head detection. It includes 7581 images with 9044 human safety helmet wearing objects(positive) and 111514 normal head objects(not wearing or negative)."

В представленном описании имеются неточности: размечено 9058 объектов класса "hat" и 111710 объектов класса "person".

### Разделение на тренировочную и валидационную выборки

В валидационную часть выборки было отнесено такое количество изображений, чтобы количество объектов каждого класса составляло 20% от числа объектов данного класса (не количество файлов, т.к. разные файлы могут содержать различное количество объектов). Общее количество объектов в валидационной выборке составило 1812 для класса *helmet* ("person") и 22345 объектов класса *head* ("person"), суммарное количество файлов составило 1517. Объекты выбирались случайным образом. Очевидно, что оставшаяся часть датасета использовалась для обучения.

Список файлов для соответствующей части выборки распологается в корневом разделе датасета в json формате в файлах `helmet_valid_image_filenames.json`/`helmet_train_image_filenames.json`, соответвственно для валидационной и обучающей выборок.

Способ чтения данных из этих файлов следующий: (пример чтения списка имён файлов валидационной части):

```
with open(dataset_path + "helmet_valid_image_filenames.json", 'r') as f:
    helmet_valid = json.load(f)
```
### Данные о разметке

Вся полезная информация о разметке (о классах и их количестве), полученная из файлов формата xml, располагается в в файле `data_fn.json`. Данные - словарь, ключом является имя файла изображения (вместе с раширением).

## Модель / ответственный за подготовку

- YOLO:
    1. YOLOv5 su / Даниил Васильев
    2. YOLOv7 nano / Варвара Фадеева
    3. YOLOv8 medium / Владислав Вебер
- SSDLite (MobileNet backbone) / Владимир Гузанов

